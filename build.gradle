apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'maven'

sourceCompatibility = 1.8
targetCompatibility = 1.8

[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

jar {
	manifest {
		attributes(
			"provider" : 'GY',
			"Class-Path" : '. ' + configurations.runtime.collect{'lib/' + it.getName()}.join(' ')
		)
	}
}

repositories {
	jcenter()
}

dependencies {
	implementation "io.netty:netty-all:4.1.+"
	implementation "org.apache.logging.log4j:log4j-1.2-api:2.8.+"
	implementation "org.apache.logging.log4j:log4j-api:2.8.+"
	implementation "org.apache.logging.log4j:log4j-core:2.8.+"
	implementation "com.lmax:disruptor:3.3.+"
	implementation "com.google.code.gson:gson:2.8.+"
}

task mkdir {
	doLast {
		sourceSets*.java.srcDirs*.each {it.mkdirs()}
		sourceSets*.resources.srcDirs*.each {it.mkdirs()}
	}
}

task releaseJars(type:Copy) {
	from 'build/libs/'
	from sourceSets.main.resources
	into './dist/micore'
}

task releaseLibs(type:Copy) {
	from configurations.runtime
	into 'build/libs/lib'
}